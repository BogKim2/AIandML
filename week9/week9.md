# Week 9: 고전 역학 시뮬레이션

## 📚 학습 목표

이번 주차에서는 고전 역학의 핵심 개념들을 수치 시뮬레이션을 통해 학습합니다.

**배울 내용:**
1. 수치 적분 방법 (Euler vs RK4)
2. 행성 운동과 케플러 법칙
3. 혼돈 시스템 (이중 진자)
4. 라그랑지안과 해밀토니안 역학

**왜 중요한가?**
- 대부분의 물리 문제는 해석적으로 풀 수 없음
- 컴퓨터 시뮬레이션이 필수
- 실제 공학/과학 연구에서 광범위하게 사용

---

## 🎯 들어가기: 왜 수치 해법인가?

### 해석적 해가 가능한 경우 (드뭄)
- 단순 조화 진동자: x(t) = A·cos(ωt + φ)
- 등가속도 운동: x(t) = x₀ + v₀t + ½at²
- 케플러 문제 (2체 문제): 타원 궤도

### 해석적 해가 불가능한 경우 (대부분!)
- 비선형 진자: sin(θ) ≠ θ
- 3체 문제: 태양-지구-달
- 감쇠/마찰이 있는 시스템
- 복잡한 포텐셜

**해결책: 수치 적분!**
- 미분 방정식을 작은 단계로 근사
- 컴퓨터로 계산
- 원하는 정확도까지 반복

---

## 🔬 Lab 1: 수치 적분 방법 비교 (01euler_rk4.py)

### 목적
오일러 방법과 RK4 방법의 정확도와 안정성을 비교합니다.

### 프로그램 실행
```bash
cd week9
python 01euler_rk4.py
```

### 1. 오일러 방법 (Euler Method)

**기본 아이디어:**
미분의 정의를 직접 사용
```
dy/dt ≈ (y(t+Δt) - y(t)) / Δt
→ y(t+Δt) = y(t) + Δt · f(y, t)
```

**알고리즘:**
```python
def euler_step(f, y, t, dt):
    return y + dt * f(y, t)
```

**장점:**
- 매우 간단
- 직관적
- 빠름 (1회 함수 평가)

**단점:**
- 1차 정확도: 오차 ∝ Δt
- 오차 누적이 심함
- 에너지가 보존되지 않음

### 2. Runge-Kutta 4차 방법 (RK4)

**기본 아이디어:**
4개의 기울기를 계산하여 가중 평균
```
k₁ = f(y, t)
k₂ = f(y + ½Δt·k₁, t + ½Δt)
k₃ = f(y + ½Δt·k₂, t + ½Δt)
k₄ = f(y + Δt·k₃, t + Δt)

y(t+Δt) = y(t) + (Δt/6)(k₁ + 2k₂ + 2k₃ + k₄)
```

**알고리즘:**
```python
def rk4_step(f, y, t, dt):
    k1 = f(y, t)
    k2 = f(y + 0.5*dt*k1, t + 0.5*dt)
    k3 = f(y + 0.5*dt*k2, t + 0.5*dt)
    k4 = f(y + dt*k3, t + dt)
    return y + (dt/6) * (k1 + 2*k2 + 2*k3 + k4)
```

**장점:**
- 4차 정확도: 오차 ∝ Δt⁴
- 매우 안정적
- 에너지가 잘 보존됨
- 산업 표준

**단점:**
- 복잡함
- 느림 (4회 함수 평가)

### 3. 테스트 시스템

#### 단순 조화 진동자
```
운동 방정식: d²x/dt² = -ω²x
해석해: x(t) = A·cos(ωt + φ)
에너지: E = ½m(v² + ω²x²) = 일정
```

#### 감쇠 진자
```
운동 방정식: d²θ/dt² = -ω²sin(θ) - γ·dθ/dt
비선형 + 감쇠
해석해 없음!
```

### 4. 결과 비교

| 항목 | Euler | RK4 |
|------|-------|-----|
| 정확도 | O(Δt) | O(Δt⁴) |
| 계산 비용 | 1× | 4× |
| 10초 후 오차 | ~10% | <0.01% |
| 에너지 보존 | 나쁨 | 우수 |
| 권장 사용 | 학습용 | 실제 사용 |

**핵심 메시지:**
RK4는 4배 느리지만 100-1000배 더 정확합니다!

### 5. 출력 파일
- `01_euler_vs_rk4.png`: 두 방법 비교
- `01_error_analysis.png`: 오차 분석

---

## 🪐 Lab 2: 행성 운동 시뮬레이션 (02planetary.py)

### 목적
뉴턴의 만유인력 법칙으로 행성 운동을 시뮬레이션하고 케플러 법칙을 검증합니다.

### 프로그램 실행
```bash
python 02planetary.py
```

### 1. 뉴턴의 만유인력 법칙

```
F = -G·M·m/r² · r̂
```

- G: 만유인력 상수 = 4π² AU³/(M_☉·year²)
- M: 태양 질량
- m: 행성 질량
- r: 태양-행성 거리

**운동 방정식:**
```
d²r/dt² = -G·M/r³ · r
```

이는 2차 미분 방정식입니다. 상태 변수로 변환:
```
y = [x, y, vₓ, vᵧ]
dy/dt = [vₓ, vᵧ, aₓ, aᵧ]

여기서 a = -G·M/r³ · r
```

### 2. 케플러의 법칙

#### 제1법칙: 타원 궤도
"행성의 궤도는 타원이고, 태양은 한 초점에 있다"

타원 방정식:
```
r = a(1-e²) / (1 + e·cos(θ))
```
- a: 장반경 (타원의 긴 반지름)
- e: 이심률 (0: 원, 0<e<1: 타원)

#### 제2법칙: 면적 속도 일정
"행성과 태양을 잇는 선분이 같은 시간에 쓸고 지나는 면적은 같다"

수학적으로:
```
dA/dt = L/(2m) = 일정
```
- L: 각운동량
- 보존 법칙의 결과!

**물리적 의미:**
- 근일점 (가까움): 빠르게 움직임
- 원일점 (멀리): 느리게 움직임

#### 제3법칙: 주기-거리 관계
"공전 주기의 제곱은 장반경의 세제곱에 비례한다"

```
T² = (4π²/GM) · a³
T² ∝ a³
```

**검증:**
| 행성 | 장반경 a (AU) | 주기 T (year) | T²/a³ |
|------|--------------|--------------|-------|
| 지구 | 1.000 | 1.000 | 1.000 |
| 화성 | 1.524 | 1.881 | 1.000 |
| 목성 | 5.203 | 11.86 | 1.000 |

완벽한 일치! ✓

### 3. 보존 법칙

#### 에너지 보존
```
E = T + V = ½mv² - GMm/r = 일정
```

#### 각운동량 보존
```
L = m·r×v = 일정 (크기와 방향)
```

**시뮬레이션에서 확인:**
- 에너지 변동 < 0.01%
- 각운동량 변동 < 0.01%

### 4. 출력 파일
- `02_solar_system.png`: 태양계 궤도
- `02_orbital_parameters.png`: 궤도 매개변수
- `02_kepler_laws.png`: 케플러 법칙 검증

---

## 🌀 Lab 3: 혼돈 시스템 (03chaotic_pendulum.py)

### 목적
이중 진자를 통해 혼돈(chaos)의 개념을 이해합니다.

### 프로그램 실행
```bash
python 03chaotic_pendulum.py
```

### 1. 혼돈이란?

**정의:**
- 결정론적 시스템 (방정식이 명확)
- 하지만 예측 불가능
- 초기 조건에 극도로 민감

**예:**
- 날씨 예보 (나비 효과)
- 주식 시장
- 난류
- 이중 진자

### 2. 이중 진자

**시스템:**
- 두 개의 진자가 연결됨
- 각각 길이 L₁, L₂, 질량 m₁, m₂
- 중력 작용

**운동 방정식:**
매우 복잡한 결합 미분 방정식!
```
(m₁+m₂)L₁·θ̈₁ + m₂L₂·θ̈₂·cos(θ₁-θ₂) + ... = 0
L₂·θ̈₂ + L₁·θ̈₁·cos(θ₁-θ₂) + ... = 0
```

**왜 복잡한가?**
- 비선형 (sin, cos)
- 결합 (θ₁과 θ₂가 상호작용)
- 해석적 해 불가능

### 3. 나비 효과 (Butterfly Effect)

**실험:**
두 개의 이중 진자를 같은 초기 조건에서 시작... 
하지만 0.001도 차이!

```
진자 A: θ₂ = 90.000°
진자 B: θ₂ = 90.001°
```

**결과:**
- 처음 몇 초: 거의 같은 궤적
- 10초 후: 눈에 띄게 다름
- 20초 후: 완전히 다른 궤적!

**수학적 설명: 리아푸노프 지수**
```
δ(t) = δ₀·e^(λt)
```
- δ(t): 시간 t에서의 차이
- δ₀: 초기 차이
- λ: 리아푸노프 지수 (양수 → 혼돈)

**예측 가능 시간:**
```
t_predictable ~ 1/λ
```

이중 진자의 경우 λ ≈ 0.3 s⁻¹
→ 예측 가능 시간 ~ 3초!

### 4. 위상 공간 (Phase Space)

**정의:**
시스템의 모든 상태를 표현하는 공간
- 좌표: (θ₁, ω₁, θ₂, ω₂)
- 4차원! (2D로 투영하여 시각화)

**특징:**
- 혼돈 시스템: 복잡한 궤적
- 규칙적 시스템: 단순한 곡선

### 5. 포앵카레 단면 (Poincaré Section)

**아이디어:**
4D 위상 공간을 2D로 자르기

**방법:**
θ₁ = 0을 지날 때마다 (θ₂, ω₂) 기록

**결과:**
- 규칙적: 점들이 곡선 위에
- 혼돈적: 점들이 흩어짐 (프랙탈 구조)

### 6. 실제 의미

**왜 중요한가?**
1. **장기 예측 불가능**
   - 날씨: 2주 이상 예측 어려움
   - 주식: 장기 예측 불가능

2. **초기 조건의 중요성**
   - 작은 오차 → 큰 차이
   - 정밀한 측정 필수

3. **자연의 본질**
   - 많은 시스템이 혼돈적
   - 무작위 아님! (결정론적)

### 7. 출력 파일
- `03_double_pendulum.png`: 이중 진자 궤적
- `03_chaos_analysis.png`: 혼돈 분석
- `03_phase_space.png`: 위상 공간

---

## ⚛️ Lab 4: 라그랑지안과 해밀토니안 역학 (04lagrangian_hamiltonian.py)

### 목적
고전 역학의 세 가지 정식화를 비교하고 그 동등성을 확인합니다.

### 프로그램 실행
```bash
python 04lagrangian_hamiltonian.py
```

### 1. 세 가지 정식화

#### 뉴턴 역학 (Newton)
```
F = ma
```
- 힘과 가속도의 관계
- 직관적
- 카테시안 좌표에 적합

#### 라그랑지안 역학 (Lagrange)
```
L = T - V (라그랑지안)
d/dt(∂L/∂q̇) - ∂L/∂q = 0 (오일러-라그랑주 방정식)
```
- 에너지 기반
- 일반화 좌표 사용 가능
- 제약 조건 자동 처리

#### 해밀토니안 역학 (Hamilton)
```
H = T + V (해밀토니안 = 총 에너지)
dq/dt = ∂H/∂p
dp/dt = -∂H/∂q (해밀턴 방정식)
```
- 위상 공간 (q, p)
- 대칭적
- 양자역학으로 확장 가능

### 2. 단순 진자 예제

**뉴턴 방법:**
```
토크: τ = I·α
-mgL·sin(θ) = mL²·d²θ/dt²
→ d²θ/dt² = -(g/L)·sin(θ)
```

**라그랑지안 방법:**
```
T = ½m(Lθ̇)² = ½mL²θ̇² (운동 에너지)
V = -mgL·cos(θ) (위치 에너지, θ=0 기준)
L = T - V = ½mL²θ̇² + mgL·cos(θ)

오일러-라그랑주 방정식:
d/dt(∂L/∂θ̇) - ∂L/∂θ = 0
→ mL²θ̈ + mgL·sin(θ) = 0
→ θ̈ = -(g/L)·sin(θ)
```

**해밀토니안 방법:**
```
정준 운동량: p = ∂L/∂θ̇ = mL²θ̇
해밀토니안: H = p²/(2mL²) - mgL·cos(θ)

해밀턴 방정식:
dθ/dt = ∂H/∂p = p/(mL²)
dp/dt = -∂H/∂θ = -mgL·sin(θ)
```

**결과: 모두 같은 운동 방정식!**

### 3. 각 방법의 장단점

#### 뉴턴 역학
**장점:**
- 직관적
- 힘이 명확할 때 간단

**단점:**
- 제약 조건 처리 복잡
- 좌표계 변환 어려움

#### 라그랑지안 역학
**장점:**
- 일반화 좌표 (극좌표, 구면 좌표 등)
- 제약 조건 자동 처리
- 대칭성 활용

**단점:**
- 개념적으로 추상적
- 초기 설정 복잡

#### 해밀토니안 역학
**장점:**
- 위상 공간에서 우아함
- 보존 법칙 명확
- 양자역학 연결
- 통계역학 기초

**단점:**
- 가장 추상적
- 직관과 거리가 멂

### 4. 언제 어떤 방법을 쓸까?

| 문제 유형 | 권장 방법 |
|----------|---------|
| 간단한 직선 운동 | 뉴턴 |
| 제약 조건 있는 시스템 | 라그랑지안 |
| 로봇 팔 운동학 | 라그랑지안 |
| 천체 역학 (보존 법칙) | 해밀토니안 |
| 양자역학 준비 | 해밀토니안 |

### 5. 작용 원리 (Principle of Least Action)

**라그랑지안의 철학적 기초:**

자연은 "작용(action)"을 최소화하는 경로를 선택한다!
```
S = ∫L dt (작용)
δS = 0 (변분이 0)
```

**의미:**
- 자연은 "게으르다"
- 가장 효율적인 경로
- 모든 물리 법칙의 기초

### 6. 양자역학과의 연결

**고전 → 양자:**
```
고전                 양자
---------------------
q (위치)        →   q̂ (위치 연산자)
p (운동량)      →   p̂ = -iℏ∂/∂q
H (에너지)      →   Ĥ = -iℏ∂/∂t
{A, B} (푸아송)  →   [Â, B̂] = ÂB̂ - B̂Â
```

**슈뢰딩거 방정식:**
```
iℏ∂ψ/∂t = Ĥψ
```
해밀토니안이 직접 나타남!

### 7. 출력 파일
- `04_comparison.png`: 세 방법 비교
- `04_lagrangian.png`: 라그랑지안 역학 상세
- `04_hamiltonian.png`: 해밀토니안 역학 상세
- `04_phase_space.png`: 위상 공간 비교

---

## 🎓 핵심 개념 정리

### 1. 수치 적분

**핵심 아이디어:**
미분 방정식을 작은 단계로 근사

**방법 비교:**
| 항목 | Euler | RK4 |
|------|-------|-----|
| 정확도 | O(Δt) | O(Δt⁴) |
| 안정성 | 나쁨 | 우수 |
| 사용 | 학습 | 실무 |

### 2. 케플러 법칙

1. **타원 궤도**: 행성은 타원을 그림
2. **면적 속도 일정**: 각운동량 보존
3. **주기-거리**: T² ∝ a³

### 3. 혼돈 (Chaos)

**특징:**
- 결정론적이지만 예측 불가능
- 초기 조건에 극도로 민감
- 리아푸노프 지수 > 0

**예:**
- 이중 진자
- 날씨
- 난류

### 4. 고전 역학의 정식화

**세 가지 방법:**
1. **뉴턴**: F = ma (직관적)
2. **라그랑지안**: L = T - V (에너지, 제약)
3. **해밀토니안**: H = T + V (위상 공간, 양자)

**핵심:** 모두 동일한 물리, 다른 관점!

---

## 💡 프로그래밍 팁

### 1. ODE 시스템 구성

**2차 미분 방정식을 1차로 변환:**
```python
# 원래: d²x/dt² = f(x, dx/dt, t)

# 변환:
# y = [x, v] where v = dx/dt
# dy/dt = [v, f(x, v, t)]

def system(y, t):
    x, v = y
    dxdt = v
    dvdt = f(x, v, t)
    return np.array([dxdt, dvdt])
```

### 2. RK4 구현

**표준 템플릿:**
```python
def rk4_step(f, y, t, dt):
    k1 = f(y, t)
    k2 = f(y + 0.5*dt*k1, t + 0.5*dt)
    k3 = f(y + 0.5*dt*k2, t + 0.5*dt)
    k4 = f(y + dt*k3, t + dt)
    return y + (dt/6) * (k1 + 2*k2 + 2*k3 + k4)
```

### 3. 시간 간격 선택

**경험 법칙:**
```
dt < T_characteristic / 100
```
- T_characteristic: 시스템의 특성 시간
- 예: 진자 주기가 2초 → dt < 0.02초

### 4. 에너지 확인

**항상 확인:**
```python
E = T + V  # 총 에너지
E_error = (E.max() - E.min()) / abs(E[0])
if E_error > 0.01:
    print("Warning: 에너지 보존 나쁨!")
```

---

## 🚀 확장 프로젝트

### 1. 3체 문제
- 태양-지구-달 시스템
- 라그랑주 점 (L1~L5)

### 2. 강체 운동
- 회전하는 물체
- 오일러 각

### 3. 혼돈의 다른 예
- 로렌츠 어트랙터 (날씨 모델)
- 헤논 맵

### 4. 해밀토니안 시스템
- 정준 변환
- 작용-각 변수

---

## 📚 참고 자료

### 교과서
1. **고전 역학**: Goldstein, "Classical Mechanics"
2. **수치 해법**: Press et al., "Numerical Recipes"
3. **혼돈**: Strogatz, "Nonlinear Dynamics and Chaos"

### 온라인
- Wikipedia: Runge-Kutta methods
- MIT OCW: Classical Mechanics (Lewin)
- 3Blue1Brown: Differential equations

---

## ✅ 학습 체크리스트

- [ ] Euler vs RK4 차이를 설명할 수 있다
- [ ] 케플러 3법칙을 이해하고 검증했다
- [ ] 혼돈의 개념을 설명할 수 있다
- [ ] 나비 효과를 시뮬레이션으로 확인했다
- [ ] 세 가지 역학 정식화의 차이를 안다
- [ ] 라그랑지안을 구성할 수 있다
- [ ] 해밀토니안 방정식을 풀 수 있다
- [ ] 위상 공간의 의미를 이해한다

---

## 🎯 마무리

이번 주차에서 배운 내용:

1. **수치 적분**: RK4가 표준
2. **케플러 법칙**: 만유인력의 결과
3. **혼돈**: 결정론 ≠ 예측 가능
4. **고급 역학**: 같은 물리, 다른 언어

**다음 단계:**
- 양자역학 (해밀토니안 → 슈뢰딩거)
- 통계역학 (위상 공간 → 앙상블)
- 연속체 역학 (장론)

고전 역학은 모든 물리학의 기초입니다! 🚀

